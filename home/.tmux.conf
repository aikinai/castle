##### ─────────────────────────────
##### Core behavior
##### ─────────────────────────────

# Use C-a as prefix (GNU screen muscle memory)
set -g prefix C-a
bind C-a send-prefix

# History and indices
set -g history-limit 10000
set -g base-index 1
setw -g pane-base-index 1

# Don’t let programs rename windows
set -g allow-rename off

# vi-style keys in status and copy mode
set -g status-keys vi
setw -g mode-keys vi

##### ─────────────────────────────
##### Copy mode: selections & yank
##### ─────────────────────────────

# Visual selection (char/rect)
bind -Tcopy-mode-vi v    send -X begin-selection
bind -Tcopy-mode-vi C-v  send -X rectangle-toggle
bind -Tcopy-mode-vi V    send -X rectangle-toggle

# Send clipboard via OSC52 when remote; pbcopy when local
# Remote = SSH/Mosh env vars present in the tmux server
set -g set-clipboard on
if-shell '[ -n "$SSH_TTY$SSH_CONNECTION$MOSH_SESSION" ]' \
  'unbind -Tcopy-mode-vi y; bind -Tcopy-mode-vi y send -X copy-selection-and-cancel; \
   unbind -Tcopy-mode-vi Enter; bind -Tcopy-mode-vi Enter send -X copy-selection-and-cancel; \
   unbind C-c; bind C-c run "tmux show-buffer | tmux set-buffer -w -"; \
   unbind C-v; bind C-v paste-buffer' \
  'unbind -Tcopy-mode-vi y; bind -Tcopy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"; \
   unbind -Tcopy-mode-vi Enter; bind -Tcopy-mode-vi Enter send -X copy-pipe-and-cancel "pbcopy"; \
   unbind C-c; bind C-c run "tmux show-buffer | pbcopy"; \
   unbind C-v; bind C-v run "pbpaste | tmux load-buffer - && tmux paste-buffer"'

##### ─────────────────────────────
##### Mouse behavior
##### ─────────────────────────────

# Enable mouse; wheel enters copy-mode to scroll, then passes through
setw -g mouse on
bind -n WheelUpPane   select-pane -t= \; copy-mode -e \; send-keys -M
bind -n WheelDownPane select-pane -t= \;                 send-keys -M

##### ─────────────────────────────
##### Pane/window navigation & splits
##### ─────────────────────────────

# hjkl to move between panes
unbind j; bind j select-pane -D
unbind k; bind k select-pane -U
unbind h; bind h select-pane -L
unbind l; bind l select-pane -R

# Splits
bind | split-window -h
bind - split-window -v

# Quick last-window (C-a a)
bind C-a last-window

##### ─────────────────────────────
##### Terminal / colors
##### ─────────────────────────────

# Advertise tmux-256color inside tmux; ensure your terminal outside uses xterm-256color or equivalent
set -g default-terminal "tmux-256color"

# Enable truecolor if terminal supports it
set -as terminal-features '*:RGB'

##### ─────────────────────────────
##### Status line & theme (via TPM)
##### ─────────────────────────────

# Status refresh & placement
set -g status-interval 2
set -g status-position bottom
set -g status-left-length 60
set -g status-right-length 120

# Window label like "1* zsh"
setw -g window-status-current-format '#[bold]#I* #W'

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'jimeh/tmux-themepack'
set -g @themepack 'powerline/default/green'

# Load TPM last (expand $HOME)
run -b "$HOME/.tmux/plugins/tpm/tpm"
